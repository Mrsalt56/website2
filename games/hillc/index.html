<!DOCTYPE html>
<html>
<head>
<title>Игра Хилл Климб Рейсинг - Vseigru.net Unblocked - Unblocked Games 67</title>
<link rel="stylesheet" href="lib/game-loader/gameloader2020.css" />
<script src="lib/game-loader/gameloader2020.js"></script>
<script>
	var onOpenTimeout = 100,
	onRewardedTimeout = 5000,
	onCloseTimeout = 5100,
	onCloseTimeoutFullAdv = 5100;
</script>
<!-- <script src="lib/ysdk/v2.js"></script> -->
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script async src="patch/js/null.js?pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4938767041116941"
     crossorigin="anonymous"></script>
<script>
            let player;
            let leaderboard;
            let payments = null;
            let promptCanShow = false;
            let reviewCanShow = false;
            let initSDK = false;
            let initGame = false;
            let photoSizeForInit;
            let scopesForInit;
            let firstAd = true;
            let nowFullAdOpen = false;

            YaGames.init().then(ysdk=>{
                console.log('Init Yandex SDK');
                window.ysdk = ysdk;
                initSDK = true;
                InitPayments();

                try {
                    ysdk.shortcut.canShowPrompt().then(prompt=>{
                        if (prompt.canShow) {
                            promptCanShow = true;
                        }
                    }
                    );
                } catch (e) {
                    console.error('CRASH canShowPrompt: ', e.message);
                }

                try {
                    ysdk.feedback.canReview().then(({value, reason})=>{
                        if (value) {
                            reviewCanShow = true;
                        } else {
                            console.log('reviewCanShow = false', reason)
                        }
                    }
                    )

                    ysdk.shortcut.canShowPrompt().then(prompt=>{
                        if (prompt.canShow) {
                            promptCanShow = true;
                        }
                    }
                    );
                } catch (e) {
                    console.error('CRASH canShowFeedback: ', e.message);
                }

                FullAdShow();
            }
            );

            function InitSDK(photoSize, scopes) {
                console.log('Init GAME');
                initGame = true;
                photoSizeForInit = photoSize;
                scopesForInit = scopes;

                if (initSDK == true) {
                    ysdk.features.LoadingAPI?.ready();
                    InitPlayer(photoSize, scopes);
                }

                if (nowFullAdOpen == true) {
                    window.unityInstance.SendMessage('YandexGame', 'OpenFullAd');
                }
            }

            function NotAuthorized() {
                try {
                    console.log('Authorized failed');
                    let authJson = {
                        "playerAuth": "rejected",
                        "playerName": "unauthorized",
                        "playerId": "unauthorized",
                        "playerPhoto": "null"
                    };
                    window.unityInstance.SendMessage('YandexGame', 'SetInitializationSDK', JSON.stringify(authJson));
                } catch (e) {
                    console.error('CRASH Not Authorized: ', e.message);
                }
            }

            function InitPlayer(photoSize, _scopes) {
                try {
                    return ysdk.getPlayer({
                        scopes: _scopes
                    }).then(_player=>{

                        player = _player;

                        let playerName = player.getName();
                        let playerPhoto = player.getPhoto(photoSize);

                        if (!_scopes) {
                            playerName = "anonymous";
                            playerPhoto = "null";
                        }

                        if (player.getMode() === 'lite') {

                            console.log('Not Authorized');
                            NotAuthorized();
                        } else {
                            let authJson = {
                                "playerAuth": "resolved",
                                "playerName": playerName,
                                "playerId": player.getUniqueID(),
                                "playerPhoto": playerPhoto
                            };
                            window.unityInstance.SendMessage('YandexGame', 'SetInitializationSDK', JSON.stringify(authJson));
                            window.focus();
                        }
                    }
                    ).catch(e=>{
                        console.error('Authorized err: ', e.message);
                        NotAuthorized();
                    }
                    );
                } catch (e) {
                    console.error('CRASH init Player: ', e.message);
                    window.focus();
                }
            }

            function OpenAuthDialog(photoSize, scopes) {
                try {
                    ysdk.auth.openAuthDialog().then(()=>{
                        InitPlayer(photoSize, scopes);
                    }
                    ).catch(()=>{
                        InitSDK(photoSize, scopes);
                    }
                    );
                } catch (e) {
                    console.log('CRASH Open Auth Dialog: ', e.message);
                }
            }

            function FullAdShow() {
                try {
                    window.ysdk.adv.showFullscreenAdv({
                        callbacks: {
                            onOpen: ()=>{
                                console.log('Open Fullscreen Ad');
                                if (initGame == true) {
                                    nowFullAdOpen = true;
                                    window.unityInstance.SendMessage('YandexGame', 'OpenFullAd');
                                }
                            }
                            ,
                            onClose: (wasShown)=>{
                                if (initGame == true) {
                                    nowFullAdOpen = false;
                                    if (wasShown) {
                                        window.unityInstance.SendMessage('YandexGame', 'CloseFullAd', 'true');
                                    } else {
                                        window.unityInstance.SendMessage('YandexGame', 'CloseFullAd', 'false');
                                    }
                                }
                                window.focus();
                            }
                            ,
                            onError: (error)=>{
                                console.error('Error Fullscreen Ad', error);
                                window.unityInstance.SendMessage('YandexGame', 'ErrorFullAd');
                                window.focus();
                            }
                        }
                    });
                } catch (e) {
                    console.error('CRASH FullAd Show: ', e.message);
                }
            }

            function RewardedShow(id) {
                try {
                    window.ysdk.adv.showRewardedVideo({
                        callbacks: {
                            onOpen: ()=>{
                                console.log('Opened Video Ad. Id: ' + id);
                                window.unityInstance.SendMessage('YandexGame', 'OpenVideo');
                            }
                            ,
                            onClose: ()=>{
                                console.log('Closed Video Ad. Id: ' + id);
                                window.unityInstance.SendMessage('YandexGame', 'CloseVideo');
                                window.focus();
                            }
                            ,
                            onRewarded: ()=>{
                                console.log('Reward Video Ad. Id: ' + id);
                                window.unityInstance.SendMessage('YandexGame', 'RewardVideo', id);
                            }
                            ,
                            onError: (e)=>{
                                console.error('Error Video Ad. Id: ' + id, e);
                                window.unityInstance.SendMessage('YandexGame', 'ErrorVideo');
                            }
                        }
                    });
                } catch (err) {
                    console.error('CRASH Rewarded Video Ad Show: ', err.message);
                }
            }

            function StickyAdActivity(show) {
                try {
                    ysdk.adv.getBannerAdvStatus().then(({stickyAdvIsShowing, reason})=>{
                        if (stickyAdvIsShowing) {
                            if (!show) {
                                ysdk.adv.hideBannerAdv();
                            }
                        } else if (reason) {
                            console.log('Sticky ad are not shown. Reason:', reason);
                        } else if (show) {
                            ysdk.adv.showBannerAdv();
                        }
                    }
                    )
                } catch (e) {
                    console.error('CRASH Sticky Activity: ', e.message);
                }
            }

            function InitPayments() {
                try {
                    ysdk.getPayments().then(_payments=>{
                        console.log('Purchases are available');
                        payments = _payments;
                    }
                    ).catch(e=>{
                        console.log('Purchases are not available', e.message);
                    }
                    )
                } catch (e) {
                    console.error('CRASH Init Payments: ', e.message);
                }
            }

            function BuyPayments(id) {
                try {
                    if (payments != null) {
                        payments.purchase(id).then(()=>{
                            console.log('Purchase Success');
                            ConsumePurchase(id);
                            window.focus();
                        }
                        ).catch(e=>{
                            console.error('Purchase Failed', e.message);
                            window.unityInstance.SendMessage('YandexGame', 'OnPurchaseFailed', id);
                            window.focus();
                        }
                        )
                    } else {
                        console.log('Payments == null');
                    }
                } catch (e) {
                    console.error('CRASH Buy Payments: ', e.message);
                    window.focus();
                }
            }

            function GetPayments() {
                try {
                    if (payments != null) {
                        payments.getCatalog().then(products=>{
                            let productID = [];
                            let title = [];
                            let description = [];
                            let imageURI = [];
                            let priceValue = [];
                            let consumed = [];

                            payments.getPurchases().then(purchases=>{
                                for (let i = 0; i < products.length; i++) {
                                    productID[i] = products[i].id;
                                    title[i] = products[i].title;
                                    description[i] = products[i].description;
                                    imageURI[i] = products[i].imageURI;
                                    priceValue[i] = products[i].priceValue;

                                    consumed[i] = true;
                                    for (i2 = 0; i2 < purchases.length; i2++) {
                                        if (purchases[i2].productID === productID[i]) {
                                            consumed[i] = false;
                                            break;
                                        }
                                    }
                                }

                                let jsonPayments = {
                                    "id": productID,
                                    "title": title,
                                    "description": description,
                                    "imageURI": imageURI,
                                    "priceValue": priceValue,
                                    "consumed": consumed
                                };

                                window.unityInstance.SendMessage('YandexGame', 'PaymentsEntries', JSON.stringify(jsonPayments));
                            }
                            );
                        }
                        );
                    } else {
                        console.log('Get Payments: payments == null');
                    }
                } catch (e) {
                    console.error('CRASH Get Payments: ', e.message);
                }
            }

            function ConsumePurchase(id) {
                try {
                    if (payments != null) {
                        payments.getPurchases().then(purchases=>{
                            for (i = 0; i < purchases.length; i++) {
                                if (purchases[i].productID === id) {
                                    payments.consumePurchase(purchases[i].purchaseToken);
                                    window.unityInstance.SendMessage('YandexGame', 'OnPurchaseSuccess', id);
                                }
                            }
                        }
                        );
                    } else
                        console.log('Consume purchase: payments null');
                } catch (e) {
                    console.error('CRASH Consume Purchase: ', e.message);
                }
            }

            function ConsumePurchases() {
                try {
                    if (payments != null) {
                        payments.getPurchases().then(purchases=>{
                            console.log('Unprocessed purchases: ', purchases.length);
                            for (i = 0; i < purchases.length; i++) {
                                payments.consumePurchase(purchases[i].purchaseToken);
                                window.unityInstance.SendMessage('YandexGame', 'OnPurchaseSuccess', purchases[i].productID);
                            }
                        }
                        );
                    } else
                        console.log('Consume purchases: payments null');
                } catch (e) {
                    console.error('CRASH Consume purchases: ', e.message);
                }
            }

            function SaveCloud(jsonData, flush) {
                try {
                    player.setData({
                        saves: [jsonData],
                    }, flush);
                } catch (e) {
                    console.error('CRASH Save Cloud: ', e.message);
                }
            }

            function LoadCloud() {
                try {
                    player.getData(["saves"]).then(data=>{
                        if (data.saves) {
                            window.unityInstance.SendMessage('YandexGame', 'SetLoadSaves', JSON.stringify(data.saves));
                        } else {
                            window.unityInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData");
                        }
                    }
                    ).catch(()=>{
                        console.error('getData Error!');
                        window.unityInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData");
                    }
                    );
                } catch (e) {
                    console.error('CRASH Load saves Cloud: ', e.message);
                    window.unityInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData");
                }
            }

            function InitLeaderboard() {
                try {
                    ysdk.getLeaderboards().then(_lb=>{
                        leaderboard = _lb
                        window.unityInstance.SendMessage('YandexGame', 'InitializedLB');
                    }
                    );
                } catch (e) {
                    console.error('CRASH Init Leaderboard: ', e.message);
                }
            }

            function SetLeaderboardScores(_name, score) {
                try {
                    ysdk.getLeaderboards().then(leaderboard=>{
                        leaderboard.setLeaderboardScore(_name, score);
                    }
                    );
                } catch (e) {
                    console.error('CRASH Set Leader board Scores: ', e.message);
                }
            }

            function GetLeaderboardScores(nameLB, maxPlayers, quantityTop, quantityAround, photoSize, auth) {
                try {
                    var jsonEntries = {
                        technoName: '',
                        isDefault: false,
                        isInvertSortOrder: false,
                        decimalOffset: 0,
                        type: ''// , title: ''
                    };

                    ysdk.getLeaderboards().then(leaderboard=>leaderboard.getLeaderboardDescription(nameLB)).then(res=>{
                        jsonEntries.technoName = nameLB;
                        jsonEntries.isDefault = res.default;
                        jsonEntries.isInvertSortOrder = res.description.invert_sort_order;
                        jsonEntries.decimalOffset = res.description.score_format.options.decimal_offset;
                        jsonEntries.type = res.description.type;
                        // Не определяется на момент 18.07.23
                        //jsonEntries.title = res.title; // Реализуйте по предпочтениям

                        return leaderboard.getLeaderboardEntries(nameLB, {
                            quantityTop: quantityTop,
                            includeUser: auth,
                            quantityAround: quantityAround
                        });
                    }
                    ).then(res=>{
                        let jsonPlayers = EntriesLB(res, maxPlayers, photoSize);
                        let combinedJson = {
                            ...jsonEntries,
                            ...jsonPlayers
                        };

                        window.unityInstance.SendMessage('YandexGame', 'LeaderboardEntries', JSON.stringify(combinedJson));
                    }
                    ).catch(error=>{
                        console.error(error);
                    }
                    );
                } catch (e) {
                    console.error('CRASH Get Leaderboard: ', e.message);
                }
            }

            function EntriesLB(res, maxPlayers, photoSize) {
                let LeaderboardEntriesText = '';
                let playersCount;

                if (res.entries.length < maxPlayers) {
                    playersCount = res.entries.length;
                } else {
                    playersCount = maxPlayers;
                }

                let ranks = new Array(playersCount);
                let photos = new Array(playersCount);
                let mames = new Array(playersCount);
                let scores = new Array(playersCount);
                let uniqueIDs = new Array(playersCount);

                for (i = 0; i < playersCount; i++) {
                    ranks[i] = res.entries[i].rank;
                    scores[i] = res.entries[i].score;
                    uniqueIDs[i] = res.entries[i].player.uniqueID;

                    if (photoSize === 'nonePhoto' || res.entries[i].player.scopePermissions.avatar !== "allow") {
                        photos[i] = 'nonePhoto';
                    } else {
                        photos[i] = res.entries[i].player.getAvatarSrc(photoSize);
                    }

                    if (res.entries[i].player.scopePermissions.public_name !== "allow") {
                        mames[i] = "anonymous";
                    } else {
                        mames[i] = res.entries[i].player.publicName;
                    }

                    LeaderboardEntriesText += ranks[i] + '. ' + mames[i] + ": " + scores[i] + '\n';
                }

                if (playersCount === 0) {
                    LeaderboardEntriesText = 'no data';
                }

                let jsonPlayers = {
                    "entries": LeaderboardEntriesText,
                    "ranks": ranks,
                    "photos": photos,
                    "names": mames,
                    "scores": scores,
                    "uniqueIDs": uniqueIDs
                };

                return jsonPlayers;
            }

            function LanguageRequest() {
                try {
                    window.unityInstance.SendMessage('YandexGame', 'SetLanguage', ysdk.environment.i18n.lang);
                } catch (e) {
                    console.error('CRASH Language Request: ', e.message);
                }
            }

            function RequestingEnvironmentData() {
                try {
                    let jsonEnvir = {
                        "language": ysdk.environment.i18n.lang,
                        "domain": ysdk.environment.i18n.tld,
                        "deviceType": ysdk.deviceInfo.type,
                        "isMobile": ysdk.deviceInfo.isMobile(),
                        "isDesktop": ysdk.deviceInfo.isDesktop(),
                        "isTablet": ysdk.deviceInfo.isTablet(),
                        "isTV": ysdk.deviceInfo.isTV(),
                        "appID": ysdk.environment.app.id,
                        "browserLang": ysdk.environment.browser.lang,
                        "payload": ysdk.environment.payload,
                        "promptCanShow": promptCanShow,
                        "reviewCanShow": reviewCanShow
                    };
                    window.unityInstance.SendMessage('YandexGame', 'SetEnvironmentData', JSON.stringify(jsonEnvir));
                } catch (e) {
                    console.error('CRASH Requesting Environment Data: ', e.message);
                }
            }

            function Review() {
                try {
                    ysdk.feedback.canReview().then(({value, reason})=>{
                        if (value) {
                            ysdk.feedback.requestReview().then(({feedbackSent})=>{
                                console.log('feedbackSent ', feedbackSent);
                                if (feedbackSent) {
                                    window.unityInstance.SendMessage('YandexGame', 'ReviewSent', 'true');
                                    console.log('Review left')
                                } else {
                                    window.unityInstance.SendMessage('YandexGame', 'ReviewSent', 'false');
                                    console.log('Review not left', reason)
                                }
                                window.focus();
                            }
                            )
                        } else {
                            console.log('Review can show = false', reason);
                            window.focus();
                        }
                    }
                    )
                } catch (e) {
                    console.error('CRASH Review: ', e.message);
                    window.focus();
                }
            }

            function PromptShow() {
                try {
                    ysdk.shortcut.showPrompt().then(result=>{
                        console.log('Shortcut created?:', result);
                        if (result.outcome === 'accepted') {
                            console.log('Prompt Success');
                            window.unityInstance.SendMessage('YandexGame', 'OnPromptSuccess');
                        } else {
                            window.unityInstance.SendMessage('YandexGame', 'OnPromptFail');
                        }
                        window.focus();
                    }
                    );
                } catch (e) {
                    console.error('CRASH Prompt Show: ', e.message);
                    window.focus();
                }
            }

            function PaintRBT(rbt) {
                try {
                    document.getElementById(rbt).style.background = '#ff0000';
                } catch (e) {
                    console.error('CRASH Paint RBT: ', e.message);
                }
            }

            function StaticRBTDeactivate() {}
</script>
</head>
<body style="overflow:hidden; margin:0; padding:0;">
<script type="text/javascript">
	var options = {
		author: "Vseigru",
		logo: "logo.jpg",
		gameName: "Хилл Климб Рейсинг",
		gameNameEu: "Hill Climb Racing",
		gameUrl: "/",
		moreLink: (""),
		allowFullscreen: true,
		locale: "ru_RU",
		loader: "unity2020",
		loaderOptions: {
			unityLoaderUrl: "Build/HillRacing.loader.js",
			unityConfigOptions: {
				dataUrl: "Build/471e0275a7c6b63cf628cfe35c55f0e3.data.unityweb",
				frameworkUrl: "Build/a568d68e4522c15b7f265ba48acacfd7.js.unityweb",
			    codeUrl: "Build/20e2b94db90874da9079038646733800.wasm.unityweb",
				streamingAssetsUrl: "StreamingAssets"
			}
		},
    };
	GameInit.load(options);	  
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8ed12369ac4aec44',t:'MTczMzM3MTMyMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
